@using SRS.Services.Models
@using SRS.Services.Models.Constants
@model ThemeOfScientificWorkModel

@{
    ViewBag.Title = "Створити";
}

<h2>Створити</h2>


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="form-horizontal">
        <h4>Наукова робота</h4>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            <label class="control-label col-md-2">Номер ДР <span class="text-danger">*</span></label>
            <div class="col-md-10">
                @Html.EditorFor(model => model.ThemeNumber, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.ThemeNumber, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">Шифр</label>
            <div class="col-md-10">
                @Html.EditorFor(model => model.Code, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Code, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">Тема <span class="text-danger">*</span></label>
            <div class="col-md-10">
                @Html.EditorFor(model => model.Value, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.Value, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">Науковий керівник <span class="text-danger">*</span></label>
            <div class="col-md-10">
                @Html.EditorFor(model => model.ScientificHead, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.ScientificHead, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            <label class="control-label col-md-2">Фінансування <span class="text-danger">*</span></label>
            @Html.DropDownList("Financial",
                                      new SelectList(ViewBag.AllFinancials, "Value", "Text"),
                                      new { @class = "form-control col-md-2", @style = "margin-left: 15px;" })
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">Період з <span class="text-danger">*</span></label>
            <div class="col-md-10">
                @Html.EditorFor(model => model.PeriodFrom, new { htmlAttributes = new { @class = "form-control", min = Dates.MinDate.ToString(Dates.DatePattern), max = Dates.MaxDate.ToString(Dates.DatePattern) } })
                @Html.ValidationMessageFor(model => model.PeriodFrom, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <label class="control-label col-md-2">Період до <span class="text-danger">*</span></label>
            <div class="col-md-10">
                @Html.EditorFor(model => model.PeriodTo, new { htmlAttributes = new { @class = "form-control", min = Dates.MinDate.ToString(Dates.DatePattern), max = Dates.MaxDate.ToString(Dates.DatePattern) } })
                @Html.ValidationMessageFor(model => model.PeriodTo, "", new { @class = "text-danger" })
            </div>
        </div>
        @if (User.IsInRole(RoleNames.Superadmin) || User.IsInRole(RoleNames.RectorateAdmin) || User.IsInRole(RoleNames.DeaneryAdmin))
        {
            if (User.IsInRole(RoleNames.Superadmin) || User.IsInRole(RoleNames.RectorateAdmin))
            {
                <div class="form-group">
                    <label class="control-label col-md-2">Факультет <span class="text-danger">*</span></label>
                    <div class="col-md-10">
                        <select id="faculty-selector" class="form-control chosen-select" name="FacultyId">
                            <option value="">Виберіть факультет</option>
                            @foreach (var faculty in ViewBag.AllFaculties)
                            {
                                <option value="@faculty.Id" selected="@(faculty.Id == Model.FacultyId)">@faculty.Name</option>
                            }
                        </select>
                        <div>
                            @Html.ValidationMessageFor(model => model.FacultyId, "", new { @class = "text-danger" })
                        </div>
                    </div>
                </div>
            }
            else
            {
                @Html.HiddenFor(model => model.FacultyId)
            }
            <div class="form-group">
                <label class="control-label col-md-2">Кафедра <span class="text-danger">*</span></label>
                <div class="col-md-10">
                    <select id="cathedra-selector" class="form-control chosen-select" name="CathedraId">
                        <option value="">Виберіть кафедру</option>
                        @foreach (var cathedra in ViewBag.AllCathedras)
                        {
                            <option value="@cathedra.Id" data-faculty="@cathedra.FacultyId" selected="@(cathedra.Id == Model.CathedraId)">@cathedra.Name</option>
                        }
                    </select>
                    <div>
                        @Html.ValidationMessageFor(model => model.CathedraId, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>
        }
        else
        {
            @Html.HiddenFor(model => model.FacultyId)
            @Html.HiddenFor(model => model.CathedraId)
        }
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Створити" class="btn btn-info" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Повернутись до списку", "Index")
</div>
@section Styles {
    @Styles.Render("~/Content/chosen/bundle")
}
@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    @Scripts.Render("~/bundles/chosen")
    @Scripts.Render("~/bundles/departmentSelector")
}
